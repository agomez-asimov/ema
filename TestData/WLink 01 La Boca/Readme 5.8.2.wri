{\rtf1\ansi\ansicpg1252\deff0\deflang1033\deflangfe1033{\fonttbl{\f0\fswiss\fprq2\fcharset0 Arial;}{\f1\fmodern\fprq1\fcharset0 Courier New;}{\f2\froman\fprq2\fcharset0 Times New Roman;}{\f3\fnil\fcharset2 Symbol;}}
{\colortbl ;\red0\green0\blue0;\red0\green0\blue255;}
{\*\generator Msftedit 5.41.15.1515;}\viewkind4\uc1\pard\nowidctlpar\qc\ul\b\f0\fs20 README Contents\par
WeatherLink for Vantage Pro, Envoy, \par
Monitor, Wizard, and Perception stations\par
\pard\nowidctlpar\ulnone\par
\ul Table of Contents\par
\ulnone\par
Version History\par
Known Bugs\par
To Install the Program\par
Installing New USB Drivers\par
Uninstalling WeatherLink\par
Requirements for HTML help\par
Note about Internet Upload configuration\par
Note to 5.2, 5.3, 5.4, 5.5, and 5.5.1 upgrade users\par
Note to APRS users\par
Features that require Rev B console firmware\par
Requirements for VP2 Repeater Support \par
Converting 4.x and 5.0/5.1 weather stations\par
Importing WeatherLink 3.x, 4.x, and 5.0/5.1 data files\par
Retrieving Data From the Data Logger\par
Time and Date formats supported\par
Using the Included Sample Templates\par
DataSets.dat and DataLists.dat File Structures\par
Data File Structure\par
Format of the Expansion_Modules\\ModuleList.dat file\par
Interpreting ISS Reception values\par
\par
\ul Verson 5.8.2 Feature\ulnone\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\b0 Updated Silicon Lab direct USB driver and VCP driver to version 5.30 for both Windows XP and Vista.\par
\pard\nowidctlpar\b\par
\ul Version 5.8.1 Bugs Fixed\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Updated USB driver DLL files, CP210xManufacturing.dll and SiUSBXp.dll\par
{\pntext\f3\'B7\tab}Fixed problem with using direct USB driver with Vista.\par
{\pntext\f3\'B7\tab}Fixed CRC error when using direct USB communication.\b\par
\pard\nowidctlpar\par
\ul Version 5.8.0 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Support has been added for the new WeatherLinkIP data logger (# 6555). \par
{\pntext\f3\'B7\tab}The Communications Port now supports both a direct USB connection  and multiple connection methods for WeatherLinkIP.\par
{\pntext\f3\'B7\tab}The Station Walkthrough has been modified to accommodate the addition of a web station.\par
\pard\nowidctlpar\b\par
\ul Version 5.8.0 Bugs Fixed\ulnone\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-540\li720\b0 WeatherLink will crash if it cannot access database files over a network.\par
\pard\nowidctlpar\ul\b\par
Version 5.7.1 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Updated new daylight savings dates for North America for years after 2006.\par
{\pntext\f3\'B7\tab}Calculated hourly rain and last 24-hour rain for APRS.\par
{\pntext\f3\'B7\tab}Changed APRS default server to "rotate.aprs.net".\par
{\pntext\f3\'B7\tab}Changed Console Diagnostic screen to display console or Envoy firmware version and/or date.\par
\pard\nowidctlpar\b\par
\ul Version 5.7.1 Bugs Fixed\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Fixed problem with yearly rain fall not showing up correctly on the "Set Yearly Rain" dialog box when the unit was "mm" instead of "inch".\par
\pard\nowidctlpar\b\par
\ul Version 5.7 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 APRS Feature changes - Option of APRS vs. NOAA report has been removed.   The standard is NOAA.   WeatherLink software now sends 2 minute average wind speed and 10 minute gust into the APRS string for NOAA requirement.   For Vantage Pro console, altimeter setting is reported instead of barometer in the APRS string.   WeatherLink now supports rotating APRS server.   The default APRS server is "rotatewx.aprs2.net"\par
{\pntext\f3\'B7\tab}Bright Sunshine Hours Report has been added to the reports menu\par
{\pntext\f3\'B7\tab}Number of COM ports have been increased to 18 ports\par
\pard\nowidctlpar\b\par
\ul Version 5.7 Beta Bugs Fixed\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 WeatherLink will no longer lock up if database files are readonly.\par
{\pntext\f3\'B7\tab}Bulletin bar no longer shows -32.767 if bar value is missing\par
{\pntext\f3\'B7\tab}Sunrise/Sunset calculation for Monitor/Wizard does not always default to Pacific Time Zone settings\par
{\pntext\f3\'B7\tab}WeatherLink now allows Palm .pdb and capitalized .PDB files to be imported into the WeatherLink software\par
{\pntext\f3\'B7\tab}Saving the plot templates now works correctly\par
\pard\nowidctlpar\b\par
\par
\ul Version 5.6 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Support for configuring VP2 repeaters.\par
{\pntext\f3\'B7\tab}Display repeater battery status.\par
{\pntext\f3\'B7\tab}Changed layout of the Alarm & Battery Status window\par
{\pntext\f3\'B7\tab}Ability to separately clear Day, Month, or Year High and Low data in the Clear dialog. Still does not allow individual sensor high/low values to be cleared.\par
{\pntext\f3\'B7\tab}If the Bulletin, Summary, etc. window is open when an APRS upload is scheduled, then additional wind parameters are included in the APRS data packet. The new data is user selectable between a 1 minute average speed with a 5 minute high speed, or a 2 minute average speed with a 10 minute high speed.\par
{\pntext\f3\'B7\tab}A table of wind speed data is displayed in the Summary window with Average and High wind speeds over the last 1, 2, 5, and 10 minutes.\par
{\pntext\f3\'B7\tab}New HTML tags for Weather Forecast, Moon Phase, Average Wind Speeds (1, 2, 5, & 10 min), High Wind Speed (1, 2, 5, & 10 min),\par
{\pntext\f3\'B7\tab}Inside Dewpoint and Inside Heat Index are calculated and shown in the Browser, Plot, and Summary windows. See the instructions below to enable this feature in existing weather station databases. \par
{\pntext\f3\'B7\tab}In the Browser window, "Rain" is renamed "Total Rain" and "ET" is renamed "Total ET" See the instructions below to enable this change in existing weather station databases.\par
{\pntext\f3\'B7\tab}Following international reporting standards, current wind direction readings of due north in the Bulletin, Summary, HTML templates, and APRS data packets, is reported as 360 instead of 0. \par
{\pntext\f3\'B7\tab}FTP uploads attempt to reset the FTP connection on the first failure, and skips uploading the rest of the files on a second (consecutive) failure.\par
{\pntext\f3\'B7\tab}Modified Wind Chill calculations between 40 F (4.4 C) and 93 F (33.9 C) to give more "intuitive" readings for temperatures above the upper limit of the official wind chill formula (which is 40 F). The result of this modification is lower wind chill values in the above temperature range than using the official formula.\par
{\pntext\f3\'B7\tab}Slight change in the Bulletin Layout for VP Plus\par
{\pntext\f3\'B7\tab}8 update profiles are available in the Internet upload feature for increased flexibility.\par
{\pntext\f3\'B7\tab}Internet Proxy settings are available in the Internet Configuration dialog. \par
{\pntext\f3\'B7\tab}Extend range of Air Density measurement value below 0 C (32 F) and above 49 C (120 F).\par
{\pntext\f3\'B7\tab}Added the ability to reset the timestamp of the last data uploaded to Weather Underground, if the Weather Underground module is installed. \par
{\pntext\f3\'B7\tab}New USB drivers that can be installed automatically when WeatherLink is installed.\par
{\pntext\f3\'B7\tab}Add a Mediterranean forecast zone between 30 N to 45 N and 10 W to 45 E.\par
{\pntext\f3\'B7\tab}Updated the default APRS server to arizona.aprs2.net and updated the default password to reflect the WeatherLink version number.\par
{\pntext\f3\'B7\tab}Fixed some issues with uploading to Weather Underground.\par
\pard\nowidctlpar\li180\par
\pard\nowidctlpar\ul\b Known Bugs in 5.6:\ulnone\b0\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\cf1 Will not print in color on a Tectonics Phaser 850 Printer\cf0\par
\cf1{\pntext\f3\'B7\tab}Weather Underground upload is not interruptible.\cf0\par
\cf1{\pntext\f3\'B7\tab}Occasionally WeatherLink tries to send the same record twice to Weather Underground (i.e. the last record of one upload is sent as the first record for the next upload). This generates a "Duplicate key" warning message which can be ignored.\cf0\par
\cf1{\pntext\f3\'B7\tab}When a Plot or Strip chart starts at midnight, the first midnight record is not displayed. This is because it "belongs" with the previous day's data.\cf0\par
\cf1{\pntext\f3\'B7\tab}The progress dialogs for downloads and internet uploads can not be hidden or minimized, even when the WeatherLink program has been minimized.\cf0\par
\cf1{\pntext\f3\'B7\tab}If you maintain your weather station on Standard time, but Windows sets your PC to Daylight savings time (or if for some other reason your station time is different from your PC time), the barometer graph in the Bulletin will have a 1-hour gap between the last data record and the current time. For Monitor and Perception stations, this means that a forecast can not be generated until the Bulletin has been running continuously for 3 hours.\cf0\par
\cf1{\pntext\f3\'B7\tab}64-bit drivers are not available for the USB datalogger. Until they can be provided by our supplier, \b the USB datalogger does not support 64-bit versions of Windows\b0 .\cf0\par
\pard\nowidctlpar\ul\b\par
Version 5.6 Beta Bugs Fixed\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 The Forecast HTML tag works for Monitor stations.\par
{\pntext\f3\'B7\tab}Fixed problems with reporting negative ISS reception percentages.\par
{\pntext\f3\'B7\tab}Added Inside Dew and Inside Heat to the Summary Window\par
{\pntext\f3\'B7\tab}Fixed APRS reporting of the new average and high wind values in non-MPH units.\par
{\pntext\f3\'B7\tab}Added "Low Console Batteries" warning message to the Bulletin and Summary windows and added the current console battery voltage to the Alarm & Battery Status window.\par
{\pntext\f3\'B7\tab}Modified the Wind Chill and Heat warning messages in the Bulletin and Summary to reflect the messages that appear on the Vantage console when the particular weather data is selected on the console, instead of the general message if another variable is selected.\par
{\pntext\f3\'B7\tab}Fixed a problem with viewing log files in different directories. \par
{\pntext\f3\'B7\tab}NOAA Year reports blank out rain data for months with no data\par
{\pntext\f3\'B7\tab}Historical gifs with Week and 2 Week time spans use Windows date format for M/D vs. D/M. \par
{\pntext\f3\'B7\tab}Fixed issue with default strip chart templates not being stored in the correct folder.\par
{\pntext\f3\'B7\tab}Fixed memory leak generating historical upload graphs\par
{\pntext\f3\'B7\tab}Fixed some anomalous High wind speed issues with internet uploads.\par
\pard\nowidctlpar\ul\b\par
Version 5.5.1 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Includes USB Drivers for Vantage USB support.  (CP2101)\par
{\pntext\f3\'B7\tab}Auto Detect functionality in communication setup dialog box.  Used to detect which port the Vantage Console is connected.  \par
{\pntext\f3\'B7\tab}Includes Streaming Data Logger Configuration software\b\par
\b0{\pntext\f3\'B7\tab}High/Low Soil moisture values larger than 128 are correctly reported as positive numbers.\b\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\b0\par
\ul\b{\pntext\f3\'B7\tab}Version 5.5 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Supports Software Expansion Modules to provide additional and optional functionality.\par
{\pntext\f3\'B7\tab}The Expansion Module Programming Interface will be published after the final 5.5 version is released to allow 3rd parties to write their own modules. This will involve creating Windows DLLs. C or C++ is the recommended development system.\par
{\pntext\f3\'B7\tab}Module Management function added to WeatherLink under the File menu.\par
{\pntext\f3\'B7\tab}Supports GLOBE soil data report format.\par
{\pntext\f3\'B7\tab}Both WeatherLink and the Expansion Modules use HTML Help. Windows 95, 98, and NT 4 require Microsoft Internet Explorer 4.0 or later and the latest version of HHUPD.exe from your WeatherLink CD or from www.microsoft.com.  \par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\li180\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\ul\b Version 5.5 Bug Fixes\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Fixed the calculation of derived wind values (such as wind chill) when the wind units are not MPH.\par
{\pntext\f3\'B7\tab}The toolbar tip window does not create a Taskbar button.\par
{\pntext\f3\'B7\tab}Fixed the font printing problem with the Strip Chart.\par
{\pntext\f3\'B7\tab}Fixed plotting of ET. The line graphs do not drop to zero at the end.\par
{\pntext\f3\'B7\tab}Station communication errors are logged more often. (Where 5.4 only displayed an error message box.)\par
{\pntext\f3\'B7\tab}Fixed Weather Underground upload problems with older browsers by using an escape sequence for the space characters in the date field of uploaded data.\par
{\pntext\f3\'B7\tab}Forces the APRS call sign to be in upper case. This was requested by the CWOP/FSL administrator.\par
{\pntext\f3\'B7\tab}Fixes some errors in Daily Summary calculations that are not visible in 5.4 but are used in 5.5 and the new expansion modules. \b Please use the "Recalculate Daily Values" command from the Browse menu to fix the values in your current database.\b0\par
{\pntext\f3\'B7\tab}Fixed SensorLink and Leaf/Soil transmitter selection in the "Set Transceivers" dialog.\par
{\pntext\f3\'B7\tab}Clears out the values in the Sunburn Risk window when the UV Index drops to zero.\par
{\pntext\f3\'B7\tab}Add the year to the dates displayed in the Strip Chart.\par
{\pntext\f3\'B7\tab}NOAA reports are stored in the Station directory instead of the Program directory so that NOAA reports from different stations do not overwrite each other.\par
{\pntext\f3\'B7\tab}UV Dose alarm is displayed correctly in the Alarm Status window.\par
{\pntext\f3\'B7\tab}Correctly scrolls the error/download log file display horizontally when there are lines longer than 127 characters.\par
{\pntext\f3\'B7\tab}Fixed the bug that causes WeatherLink to crash when you try to set the Latitude & Longitude from the Weather Underground Setup dialog.\par
{\pntext\f3\'B7\tab}Fixed loss of newly downloaded data when Windows shuts down WeatherLink.\par
{\pntext\f3\'B7\tab}[mm/hr] is shown correctly in the Summary Window.\par
{\pntext\f3\'B7\tab}Fixed a Vantage Bulletin display problem in the Current Rain section by forcing the lower limit of the vertical axis to zero.\par
{\pntext\f3\'B7\tab}Fixed a problem with year long Internet upload graphs of high / low / accumulation variables that caused an erroneous zero value at the end of the current month when the year is a leap year.\par
{\pntext\f3\'B7\tab}Command-line downloading of Monitor, Wizard, and Perception stations work for leap years.\par
{\pntext\f3\'B7\tab}Fixed invalid GLOBE midnight records (i.e. reporting 24:00 instead of 00:00).\par
{\pntext\f3\'B7\tab}The "Use 00:00" option for exporting data is fixed.\par
{\pntext\f3\'B7\tab}Fix Memory leaks in internet upload. \par
{\pntext\f3\'B7\tab}Set Transceivers dialog correctly sets Temp Only station on Vantage and Envoy systems.\par
{\pntext\f3\'B7\tab}Fix Bulletin barometer graph freezing when a month rolls over.\par
{\pntext\f3\'B7\tab}Fixed a bug in the allowed range of ET entry in the Edit record dialog. (0.254 inches is allowed).\par
{\pntext\f3\'B7\tab}Valid Barometer values for data entry and calibration are 16.00 to 32.50 inches. Values outside of this range are dashed.\par
{\pntext\f3\'B7\tab}Fixed Summary display of High/Low values with inappropriate large negative values. Specifically, soil moisture values greater than 127 or missing temperature sensors.\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\ul\b\par
\pard\nowidctlpar\li180\ulnone\b0\par
\pard\nowidctlpar\ul\b\par
Version 5.4 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Support for Monitor, Wizard, and Perception stations\par
{\pntext\f3\'B7\tab}Support for sending archived data to Weather Underground\par
{\pntext\f3\'B7\tab}Option to download archive data when you start the Bulletin/Summary\par
{\pntext\f3\'B7\tab}Duplicate midnight records on export are fixed.\par
{\pntext\f3\'B7\tab}GLOBE wind run reported in km instead of m\par
{\pntext\f3\'B7\tab}Correctly set Temp and Temp/Hum stations for Vantage and Envoy stations\par
{\pntext\f3\'B7\tab}NOAA mean temps are converted correctly from 4.x and 5.0-5.1 weather stations\par
{\pntext\f3\'B7\tab}Heat Index range extended to -57 F to 250 F\par
{\pntext\f3\'B7\tab}Sunrise Report daylight savings settings are separate from Set Time dialog settings. Automatic daylight savings time adjustments in Sunrise Reports for US, European, and Australian daylight savings times dates.\par
{\pntext\f3\'B7\tab}Improvements to Internet features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li720 More HTML tags \par
{\pntext\f3\'B7\tab}Allow FTP transfer to the home directory \par
{\pntext\f3\'B7\tab}Current wind speed gif image will not fill the background blue.\par
{\pntext\f3\'B7\tab}HTML Tags only work if the corresponding sensors are present on the station.\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\par
\ul\b{\pntext\f3\'B7\tab}Changes from WeatherLink 4.04 for Monitor, Wizard, and Perception Weather Stations\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 New Bulletin features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li720 Moon phase Icon\par
{\pntext\f3\'B7\tab}Sunrise and Sunset times.\par
{\pntext\f3\'B7\tab}Weather Forecast in the Bulletin/Summary for Monitor and Perception stations - Both as a text message and as a forecast icon.\par
{\pntext\f3\'B7\tab}Bulletin renames Daily rain on the Monitor/Wizard to CURRENT rain\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450 New formula for Wind Chill. Software will show different values than the Monitor or Wizard console.\par
{\pntext\f3\'B7\tab}Heat Index value calculated in software is designed to work for cool and cold conditions. \par
{\pntext\f3\'B7\tab}New data parameter Temp-Hum-Wind (THW) Index that combines the features of the Heat Index and Wind Chill. \par
{\pntext\f3\'B7\tab}(GLOBE) Data Format Support for exporting records.\par
{\pntext\f3\'B7\tab}The Internet features of the Toolbox program have been integrated directly into WeatherLink\par
{\pntext\f3\'B7\tab}New Internet features include\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li720 3 independent profiles allow different files to be updated at different frequencies.\par
{\pntext\f3\'B7\tab}Internet APRS weather reporting is supported for the Citizen Weather Observers Program\par
{\pntext\f3\'B7\tab}Support for sending archived data to Weather Underground\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\par
\ul\b{\pntext\f3\'B7\tab}Version 5.3 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Added all extra temps and hums to the Summary Window.\par
{\pntext\f3\'B7\tab}Alarm Status with PC Buzzer Support & Diagnostic windows.\par
{\pntext\f3\'B7\tab}Support for extra temp hum calibration.\par
{\pntext\f3\'B7\tab}Support for extra temp hum alarms.\par
{\pntext\f3\'B7\tab}Support for Leaf/Soil alarms.\par
{\pntext\f3\'B7\tab}THSW variable supported in the browse, plots, and strip charts.\par
{\pntext\f3\'B7\tab}Console messages appear in the Summary window.\par
{\pntext\f3\'B7\tab}Console Diagnostics Report dialog added. \par
{\pntext\f3\'B7\tab}Support for WeatherLink Downloader (Palm OS product)\par
{\pntext\f3\'B7\tab}Internet Wind Chill Tag bug fixed\par
{\pntext\f3\'B7\tab}ET plots are smoother\par
{\pntext\f3\'B7\tab}Low Battery and Reception monitoring\par
{\pntext\f3\'B7\tab}(GLOBE) Data Format Support for exporting records.\par
{\pntext\f3\'B7\tab}Skin Type Scale Factor implemented for UV Meds calculations\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\par
\ul\b{\pntext\f3\'B7\tab}Version 5.2 Features\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 New database format with space for all Vantage sensor data, including Rain Rate, Solar, UV, ET, Extra Temperature, Extra Humidity, Soil Moisture, and Leaf Wetness.\par
{\pntext\f3\'B7\tab}New formula for the Heat Index designed to work for cool and cold conditions. \par
{\pntext\f3\'B7\tab}New data parameter Temp-Hum-Wind (THW) Index that combines the features of the Heat Index and Wind Chill. \par
{\pntext\f3\'B7\tab}Bulletin and Summary windows include Solar, UV, and ET data.\par
{\pntext\f3\'B7\tab}The program automatically opens the station that was open when the program was last run.\par
{\pntext\f3\'B7\tab}Supports archiving of average temperature values (instead of the temperature at the end of the archive period).\par
{\pntext\f3\'B7\tab}Dialog to set up transmitter types, and other options found in the Vantage console setup screens.\par
{\pntext\f3\'B7\tab}Convert 4.x and 5.0/5.1 weather stations or import data files from these database versions.\par
{\pntext\f3\'B7\tab}Internet APRS weather reporting is supported for the Citizen Weather Observers Program \par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\par
\ul\b{\pntext\f3\'B7\tab}Version 5.1\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlblt\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\fi-270\li450\ulnone\b0 Internet Features implemented: HTML template files, NOAA reports, Archived Data reports, Current images, and Historical graphs.\par
{\pntext\f3\'B7\tab}Inside dew point and heat index values are calculated for HTML uploads.\par
{\pntext\f3\'B7\tab}Sample templates are included.\par
{\pntext\f3\'B7\tab}Improved davisticker java applet.\par
{\pntext\f3\'B7\tab}The National Weather Service's new wind chill formula is used for all data downloaded after the software is installed.\par
{\pntext\f3\'B7\tab}Wind direction is dashed, when downloading, if the high wind speed for the archive is zero.\par
{\pntext\f3\'B7\tab}The Auto-Download feature works in the case where there is only one station.\par
{\pntext\f3\'B7\tab}Printing NOAA and Browse reports work on HP printers.\par
{\pntext\f3\'B7\tab}The CPU usage of the software is not reported as 100%.\par
\pard{\pntext\f3\'B7\tab}{\*\pn\pnlvlcont\pnf3\pnindent0{\pntxtb\'B7}}\nowidctlpar\par
\pard\nowidctlpar\ul\b\par
\par
TO INSTALL THE PROGRAM\ulnone\b0\par
\par
From the Web:\par
Download and run the file WeatherLink 56b1 Install.exe to begin the installation.\par
Follow the on screen prompts.\par
\par
From the CD:\par
Place the Install Disk in your CD ROM drive\par
The install program should start automatically. If the install program does not start, \par
choose Run from the Start menu, type D:SETUP (or E:SETUP, substituting the correct \par
drive letter for D or E), and choose OK to begin the installation.\par
Follow the on screen prompts.\par
\par
We recommend installing WeatherLink 5.6 into a different directory from any previous WeatherLink versions.\par
\par
\ul\b Installing New USB Drivers\par
\ulnone\b0\par
This version of WeatherLink contains version 4.28a of the USB drivers needed for the USB datalogger (product 6510USB). WeatherLink Version 5.7 and 5.6 shipped with version 4.28a and WeatherLink Version 5.5.1 shipped with version 4.20 of the USB drivers. \par
\par
If you do not have a USB datalogger, you do not need to install the USB drivers.\par
\par
\b This version (4.28a) of the drivers does not support 64-bit versions of Windows! \par
\b0\par
If you have NOT previously installed a USB driver for your USB datalogger, make sure you select to install the USB Drivers when you install WeatherLink and then click Yes when the installer asks you if you want to install the drivers.\par
\par
\ul\b Uninstalling the Old USB Drivers\ulnone\b0\par
\par
If you have previously installed the previous version of the driver and have experienced problems with your USB connection, or if you want to update your driver on general principles, you will need to first un-install the old driver before you install the new driver. or before you install WeatherLink.\par
\par
To uninstall the old USB driver, first open up the Device Manager. Depending on which version of Windows you have, you can get to the device manager either by right-clicking the "My Computer" desktop icon and selecting Properties (or opening the System icon on the control panel), opening the Hardware tab, and clicking on the Device manager button; or by right-clicking on the "My Computer" desktop icon, selecting Manage, and clicking on the Device Manager icon in the left hand window.\par
\par
In the Device Manager, open the tree under the heading "Universal Serial Bus controllers". If you do not see an entry named "CP2101 USB Composite Device" or "CP210x USB Composite Device", plug in your WeatherLink USB datalogger to cause it to appear. \par
\par
Double click on the device entry ("CP2101 USB Composite Device" or "CP210x USB Composite Device") to bring up the property page. Click on the "Driver" tab to view the driver version and date which should be one of these two values: Old driver 4.20.0.2700 3/11/2004, the new value should be 4.28.0.2700 12/16/2004.\par
\par
If the driver version and date match the ones for the new driver, you are done. Otherwise, click the Uninstall button to uninstall the driver. Disconnect the USB datalogger so that Windows does not try to find a new driver for it. (If the Hardware Wizard launches, cancel out of it without loading a driver.)\par
\par
To install the new drivers, run the program PreInstaller.exe that is located in the USB_Drivers_4.28a folder inside the WeatherLink program folder where you installed it. (The default is "C:\\WeatherLink\\USB_Drivers_4.28x\\PreInstaller.exe".) One way to do this is to click the Start menu and select Run. Then click the Browse... button navigate to and select the PreInstaller.exe file and click "Open". Click "OK" to launch the USB driver installer, and click "Install" to install the USB drivers.\par
\par
\par
\ul\b Uninstalling WeatherLink.\par
\par
\ulnone Versions 5.5 and earlier\par
\b0 WeatherLink versions 5.5 and earlier do not have uninstall programs. If it is installed in a different directory from the current WeatherLink installation, you can uninstall it by deleting all of the files directly in the old WeatherLink install folder and in all of the sub-folders that are NOT weather station data folders. \par
\par
If the earlier version of WeatherLink was installed in the same directory as the current version, it can be uninstalled by deleting the following files: the exe file (WeatherLinkXX.exe where XX is the old version number), the online help file (WeatherLinkXX.chm or WeatherLinkXX.hlp, *.GID, and *.cnt) and the obsolete header files NOAA.hdr, Rain.hdr. \par
\par
Finally, delete any desktop shortcuts by single clicking and pressing the delete key or right clicking and selecting Delete from the pop-up menu. The Start menu folder and icons can be removed by right clicking them and selecting delete from the popup menu.\par
\par
\b Versions 5.5.1 and later\par
\b0 Starting with version 5.5.1 WeatherLink uses the InstallSheild install engine which provides automatic uninstall functions. Starting with version 5.6, an Uninstall shortcut icon is included in the WeatherLink Start menu folder. \par
\par
To uninstall version 5.5.1, open up the "Add or Remove Programs" icon from the control panel. This will bring up a list of programs that have been registered with Windows. Select WeatherLink 5.5.1 from the list and press the Change/Remove button, and select Remove from the InstallShield Wizard dialog box.\par
\par
\b WARNING! \b0 If 5.5.1 is installed in the same directory as 5.6 or later, uninstalling 5.5.1 will delete important file used by 5.6 (progdata.dat (program configuration file); monitor.str, percep.str, wizard.str, vantage.str (default strip-chart templates); monitor.ate, percep.ate, wizard.ate, vantage.ate (default plot templates); the Sample Template directory, and the Streaming Data Module Utility directory. You can restore the factory default versions of these files can be recreated by reinstalling the latest version of WeatherLink after 5.5.1 is uninstalled. If you want to save custom settings in any of these files, you should move, copy, or rename the file before uninstalling 5.5.1 and restore the file after re-installing the latest version of WeatherLink.\par
\par
To uninstall version 5.6 or later, you can either use the uninstall icon that is placed in the WeatherLink Start menu folder, or use the same "Add or Remove Programs" interface used by version 5.5.1. \par
\par
Starting with version 5.6 the program configuration files and default plot and stripchart template files are marked as "Shared" files and are either not deleted at all, or are deleted only if there are no other (5.6 or later) versions of WeatherLink installed. This feature will cause InstallSheild to generate a lot of "do you want to delete a Shared file" messages when you delete the last version of WeatherLink from your computer.\par
\par
\par
\ul\b Requirements for HTML help\par
\b0\par
\ulnone If you experience problems opening WeatherLink's online help files with Windows 95 or NT, please make sure you have Internet Explorer version 4.0 or later installed. For problems with other versions of Windows, please visit the Microsoft website to install the latest updates to your operating system.\par
\par
In addition, you will need to install the HTML Help system on your computer. If your Internet Explorer is version 4, run the program HHUpd_IE4.Exe which can be found the WeatherLink installation CD. If your Internet Explorer is version 5 or later, run the program HHUpd_IE5.Exe which is also on the WeatherLink installation CD. \par
\par
If you do not have a WeatherLink installation CD, you can download the appropriate file from Microsoft's web site:\par
Version for IE 4: \par
1) Go to the following website and download hhlpinst.EXE\par
\ul http://www.microsoft.com/downloads/details.aspx?FamilyID=2363a6fc-cb70-464d-85e6-f598c11ccecf&DisplayLang=en\ulnone\par
2) Run the program to extract the file HHUpd.Exe into a directory you select\par
3) Run the program HHUpd.EXE to install the HTML Help components\par
\par
Version for IE 5:\par
1) Go to the following website and download HHUPD.EXE\par
\ul http://msdn.microsoft.com/library/default.asp?url=/library/en-us/htmlhelp/html/hwmicrosofthtmlhelpdownloads.asp\ulnone\par
2) Run HHUPD.EXE to install the HTML Help components.\par
\par
\b Windows XP, 2000, ME, and 98 users should not run any version of HHUpd.Exe.\b0  \par
\par
Any urgent updates will be handled by means of service packs or Windows Update. Please check the Microsoft website to make sure you have the latest updates for your operating system.\par
\par
\par
\ul\b Note about Internet Upload configuration\par
\pard\nowidctlpar\sa120\ulnone\b0 In order to support new internet upload functionality, WeatherLink 5.6 uses a new internet configuration file format. WeatherLink 5.6 automatically converts the Internet.cfg file to the new format when it first opens a weather station. The new configuration file is named "Inet-Configuration.cfg". \par
\pard\nowidctlpar If you switch back and forth between WeatherLink 5.6 and earlier WeatherLink versions, changes to the internet configuration only apply to the active WeatherLink version.\par
\par
\ul\b Note to 5.2, 5.3, 5.4, 5.5, and 5.5.1 upgrade users\par
\ulnone\b0\par
There is no need to "convert" 5.2, 5.3, 5.4, 5.5, or 5.5.1 weather stations or weather data for WeatherLink 5.6.  Simply use \ul Open Station\ulnone  and select the station you were using with 5.2 (through 5.5.1). If you installed 5.6 in a different directory from your previous WeatherLink version, you can use Windows Explorer to copy or move your station directory into your 5.6 program directory. \par
\par
Do not attempt to use the \ul Import Database Files\ulnone  with files created by WeatherLink 5.2 (through 5.5.1). Instead, you can copy these database files directly into 5.6 weather stations.\par
\par
If you have a Solar Radiation sensor, please run "Recalculate THSW Index" from the Browse menu to calculate THSW values for your historical data downloaded with 5.2. This is not required for 5.3 or later data sets.\par
 \par
\par
\ul\b Note to APRS users\par
\par
\ulnone\b0 The default APRS server has been changed from "aprswest.net" to "arizona.aprs2.net". \par
\par
The names of the preferred servers to use to upload APRS data are subject to change, so it is a good idea to check documentation on the internet for the latest information. A good site to use is http://wxqa.com/index.html .\par
\par
In addition, the default "password" has been updated to reflect the current version of WeatherLink.\par
 \par
Please open the \ul APRS Setup\ulnone  dialog (via the \ul Configure APRS\ulnone  button in the \ul Data Upload Profile X\ulnone  dialog) and click the \ul Default\ulnone  button to switch your APRS connection to the new APRS server.\par
\par
APRS call signs should be in upper case. WeatherLink will convert lower case call signs into upper case.\par
\par
\par
\ul\b Features that require Rev B Vantage console firmware\par
\ulnone\b0\par
Some of the features of the software require Rev B Vantage console firmware.\par
Note: All VantagePro 2 consoles are Rev B.\par
\par
Press the Done and + keys to see the firmware version and date on the ticker display.\par
\par
The following features are not available with Rev A consoles:\par
Barometer trend on the Summary display and HTML tags\par
High Solar Radiation and High UV Index for each archive interval. \par
\par
This does not affect Monitor or Perception stations. Barometer Trend is available on all versions of these stations. \par
\par
\ul\b Requirements for VP2 Repeater Support \par
\ulnone\b0\par
Support for the VantagePro2 Repeater products (#7626 and #7627) is only available on Vantage Pro 2 consoles with firmware dated May 2005 or later. \par
\par
The Repeater products for the Original Vantage Pro product line (#7624 and #7625) do not require explicit support by either the console firmware or WeatherLink software, so no firmware date restrictions are imposed.. \par
\par
\ul\b Converting 4.x and 5.0/5.1 weather stations\ulnone\b0\par
\par
This method converts all the data files in an existing WeatherLink station directory. It also retains the previously entered station configuration data.\par
\par
\pard\nowidctlpar\fi-270\li270 1.  Use Windows Explorer to copy the station folder from your previous WeatherLink program folder to the WeatherLink 5.4 program folder.\par
\pard\nowidctlpar 2.  Use the Open Station command in the File Menu to open the copied station folder.\par
\pard\nowidctlpar\li720 WeatherLink will automatically detect that the station was created by a previous version of the software and ask if you want to convert the data and station.\par
\pard\nowidctlpar\par
3.  Choose OK to convert the station configuration, including the weather data files.\par
\par
WeatherLink automatically creates a backup copy of the old files and converts them for use by WeatherLink 5.4. \par
\par
\par
\ul\b Importing WeatherLink 3.x,  4.x,  5.0, and 5.1 Data Files\par
\ulnone\b0\i (\b\i0 applies only to conversions from 5.1 or earlier)\par
\b0\par
This method allows you to select individual files or groups of files to be converted for use by WeatherLink 5.4.\par
\par
\pard\nowidctlpar\fi-270\li270 1.  Create a new station, or open an existing station. Imported data will be added to this station's weather database. \par
\pard\nowidctlpar 2.  Choose Import Data Files from the File menu.\par
3.  Select the data files you want to import. \par
\pard\nowidctlpar\li720 You can select one file or multiple files in the same folder.\par
\pard\nowidctlpar\par
\pard\nowidctlpar\fi-270\li270 4.  Choose OPEN to have the selected files copied to your current station directory and converted for use by WeatherLink 5.4.\par
\pard\nowidctlpar\li720 Note: If you try to convert a data file for the same month and year as an existing WeatherLink 5.4 data file, the converted file will be put in a subdirectory called "Converted Database Files". \par
\pard\nowidctlpar\par
\par
\ul\b Retrieving Data From the Data Logger\par
\ulnone\b0\i (\b\i0 applies only to conversions with Vantage stations from versions 5.0 - 5.1)\b0\par
\par
Retrieving Data From the Data Logger\par
\par
The archive memory in your Vantage Pro WeatherLink data logger contains data not used by WeatherLink 5.0 or 5.1, such as UV, solar radiation, and rain rate. Depending on the archive interval, you may have up to 200 days of this data in your logger. Using WeatherLink 5.2 this data can be downloaded and included in your WeatherLink data files.\par
To incorporate this data into your WeatherLink data files:\par
\par
1.  Choose New Station in the File menu to create a temporary weather station folder.\par
2.  Choose Download in the File menu or click on the download icon.\par
\tab WeatherLink will do a full download of all data stored in the data logger. \par
\par
3.  Choose Browse in the Window menu or click on the Browse icon.\par
4.  Scroll to the beginning of the data file, and write down the time and date of the first entry in the database.\par
5.  Open your original WeatherLink station using the Open Station command in the File menu.\par
6.  Choose Browse in the Window menu or click on the Browse icon.\par
7.  Choose Delete Records in the Browse Menu\par
8.  Select the records for all the days following the earliest date in your temporary station database. \par
\pard\nowidctlpar\li720 Note:\tab Do not select the records for the day on which your temporary database begins. We will individually delete the records for that day in the next step.\par
\pard\nowidctlpar\par
\pard\nowidctlpar\fi-270\li270 9.  In the Browse Window, you will need to individually select and delete each record in the data base that is dated after the earliest record in your temporary database.\par
\pard\nowidctlpar\fi-360\li360 10. Once you have finished with the deleting, choose Download in the File menu or click on the Download icon to download data from the data logger.\par
\pard\nowidctlpar\li720 You should now have records in your data base up to the current time that include all the new information that has been stored in your data logger.\par
\pard\nowidctlpar 11. You can now delete the temporary station you created in Step 1.\par
\par
\par
\ul\b Time and Date Formats Supported\par
\ulnone\b0\par
Use the "Regional Settings" or "International Settings" in the Windows Control Panel. \par
\par
On the Time tab, select either 24 hour or 12 hour (am/pm) mode. \par
You can also select a time separation character (usually it is ":")\par
\par
On Date tab, you can select one of the following date orders in the Short date style:\par
Day-Month-Year, Month-Day-Year, or Year-Month-Day. Other date formats are not supported.\par
You can also select a date separation character (typically it is "/", "-", or ".")\par
\par
Other aspects of Time and Date display are set in the program and can not be changed.\par
\par
\par
\ul\b Using the Included Sample Templates\par
\ulnone\b0\par
The master copy of the included sample Templates can be found in the directory "Sample Templates" in the installed program directory. There are several separate website examples in separate sub-directories. It is not intended that all included templates be used at the same time. \par
\par
We recommend that you copy the templates you intend to use into the "Templates" sub-directory in the station directory you intend to use. While this is not required in this release, because only one station at a time can upload to the internet, future releases may allow multiple stations to upload the same template file, which will need to be in separate directories to avoid collisions between the converted HTML files.\par
\par
Each sample template directory contains a file named "Template Description.txt" that describes how to use the templates in that directory and what WeatherLink settings to use. \par
\ul\b\par
\par
Copyright Notice\par
\ulnone\b0\par
The GIF images created for upload are generated by version 1.3 of the gd library. The following copyright notice applies only to that feature of the WeatherLink software.\par
\par
\pard\nowidctlpar\tx0\tx959\tx1918\tx2877\tx3836\tx4795\tx5754\tx6713\tx7672\tx8631\f1 COPYRIGHT STATEMENT FOLLOWS THIS LINE\par
\pard\nowidctlpar\li360\ri360\f2\fs24 Portions copyright 1994, 1995, 1996, 1997, 1998, by Cold Spring Harbor Laboratory. Funded under Grant P41-RR02188 by the National Institutes of Health. \par
Portions copyright 1996, 1997, 1998, by Boutell.Com, Inc. \par
GIF decompression code copyright 1990, 1991, 1993, by David Koblas (koblas@netcom.com). \par
Non-LZW-based GIF compression code copyright 1998, by Hutchison Avenue Software Corporation (\cf2\ul <http://www.hasc.com>\cf0\ulnone , info@hasc.com). \par
\b Permission has been granted to copy and distribute gd in any context, including a commercial application, provided that this notice is present in user-accessible supporting documentation.\b0  \par
This does not affect your ownership of the derived work itself, and the intent is to assure proper credit for the authors of gd, not to interfere with your productive use of gd. If you have questions, ask. "Derived works" includes all programs that utilize the library. Credit must be given in user-accessible documentation. \par
Permission to use, copy, modify, and distribute this software and its documentation for any purpose and without fee is hereby granted, provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in supporting documentation. This software is provided "as is" without express or implied warranty. \par
\pard\nowidctlpar\f0\fs20  \par
\pard\nowidctlpar\tx0\tx959\tx1918\tx2877\tx3836\tx4795\tx5754\tx6713\tx7672\tx8631\f1 END OF COPYRIGHT STATEMENT\par
\pard\nowidctlpar\f0\par
\ul\b DataSets.dat and DataLists.dat File Structure\par
\ulnone\b0\par
Each station has its own copy of the DataSets.dat and DataLists.dat files to record information about data values to plot and browse.\par
 \f1\fs18\par
\f0\fs20 The file DataSets.dat contains information about all the data values that can be plotted and browsed. This file contains the master list, including sensors that have not been selected in the station configuration dialog.\par
\par
The file DataLists.dat contains information about which variables to make available for plotting and browsing. \par
\par
\ul\b Format of the DataSets.dat file\par
\par
\ulnone\b0 The file consists of 3 sets of data variables. The first set contains variables related to archived data. The second list contains variables related to daily summary values. The third set contains information about the colors to use with overlay plots. The daily summary variables are not fully implemented.\par
\par
The first line of a data set is the name of the data set.\par
The next lines contain the data variables, one on each line.\par
The end of the data set is marked by a line with a single period (".").\par
\par
The data variable definition is a tab delimited line with 12 fields.\par
\par
Field\tab\tab Type\tab\tab Comments\par
\pard\nowidctlpar\tx1440 Full Name\tab Text\tab\tab The full name appears in plot titles\par
\pard\nowidctlpar\fi-2880\li2880\tx1440 Data ID              Number\tab This number identifies what data value to retrieve from the weather database.\b  Do not modify this value!\par
\b0 Browser Line 1\tab Text\tab The first line of the title used in the Browser. Use a "^" to indicate a blank line.\par
Browser Line 2\tab Text\tab The second line of the title used in the Browser. Use a "^" to indicate a blank line.\par
Browser Width   Number\tab Width of the data column in the Browser. This value is in characters, and includes the padding value. \par
Browser Pad.\tab Number\tab Number of spaces to add to the right of numbers in the browser. The Browser Width and Browser Pad values control the spacing and alignment of the browser display. To add padding to Browser titles, use space characters\par
Short Name\tab Text\tab This text is used for the selection buttons in the plot window and in menus.\par
Screen Color\tab Color Value\tab Color to use on the screen\par
Color Printer\tab Color Value\tab Color to use on Color printers\par
B&W Printer\tab Color Value\tab Color (grey scale) to use on Black and White printers\par
Web Color\tab Color Value\tab Color to use on Internet graphics\par
Line Style\tab Number\tab Not implemented\par
\pard\nowidctlpar\fi-2880\li2880\par
\pard\nowidctlpar While the Color Value is given in decimal in the DataSets.dat file, if it was converted to hex it would have the format \f1\fs18 0x00bbggrr\f0\fs20 . \f1\fs18 bb\f0\fs20 , \f1\fs18 gg\f0\fs20 , and \f1\fs18 rr\f0\fs20  represent the intensities of Blue, Green and Red and can have values between 0x00 (0 = dark) and 0xFF (255 = light). When you use the color selector in the Plot and strip chart, the color selected is used for the Screen color, Color printer color, and Web color. At the same time an equivalent grey-scale color is created for the Black & While printer color.\par
\par
Davis does not provide any support for modifications of this file. The only fields that should be modified are the name and title fields to create custom names, the width and padding fields if the modified titles require them, and the color values if you want greater flexibility (i.e. to use a different color for web graphics). Do not remove or add lines to the DataSets file.\par
\par
If the DataSets.dat file is missing when the station is opened, a new one will be generated with the factory default values.\par
\par
\ul\b Format of the DataLists.dat file\par
\par
\ulnone\b0 The file consists of 5 lists of data variables. The first list contains variables to appear in the Browser. The second list is not implemented. The third list contains variables to appear in the Plot. The fourth list contains variables to appear in the Strip Chart. The Fifth list contains the Overlay variables.\par
\par
The first line of a data list is the name of the data list.\par
The next lines contain the list entries, one on each line.\par
The end of the data list is marked by a line with a single period (".").\par
\par
Each list entry consists of two numbers separated by a tab. The first number is the set number (starting with 0) found in the DataSets.dat file. The second number is the position within the data set. For example the entry (0  10) is in the 11'th entry in the first data set which is Wind Chill.\par
\par
If this file is missing, a new one will be generated based on the settings in the Station Configuration dialog.\par
\f1\fs18\par
\f0\fs20\par
\ul\b Data File Structure\par
\ulnone\b0\par
What follows is a technical description of the .WLK weather database files. This is of interest mostly to programmers who want to write their own programs to read the data files. \par
\par
The data filename has the following format: YYYY-MM.wlk where YYYY is the four digit year and MM is the two digit month of the data contained in the file.\par
\par
The structures defined below assume that no bytes are added to the structures to make the fields are on the "correct" address boundaries. With the Microsoft C++ compiler, you can use the directive "#pragma pack (1)" to enforce this and use "#pragma pack ()" to return the compiler to its default behavior.  \par
\par
\f1\fs18 //   Data is stored in monthly files.  Each file has the following header.\par
struct DayIndex \par
\{\par
   short recordsInDay;  // includes any daily summary records\par
   long startPos;    // The index (starting at 0) of the first daily summary record\par
\};      \par
\par
// Header for each monthly file.\par
// The first 16 bytes are used to identify a weather database file and to identify\par
//   different file formats. (Used for converting older database files.)\par
class HeaderBlock\par
\{ \par
   char idCode [16]; // = \{'W', 'D', 'A', 'T', '5', '.', '0', 0, 0, 0, 0, 0, 0, 0, 5, 0\}\par
   long totalRecords;\par
   DayIndex dayIndex [32]; // index records for each day. Index 0 is not used\par
                           // (i.e. the 1'st is at index 1, not index 0)\par
\};\par
\par
// After the Header are a series of 88 byte data records with one of the following\par
//   formats.  Note that each day will begin with 2 daily summary records\par
\par
// Daily Summary Record 1\par
struct DailySummary1\par
\{\par
   BYTE dataType = 2;\par
   BYTE reserved;    // this will cause the rest of the fields to start on an even address\par
\par
   short dataSpan;   // total # of minutes accounted for by physical records for this day\par
   short hiOutTemp, lowOutTemp; // tenths of a degree F\par
   short hiInTemp, lowInTemp;   // tenths of a degree F\par
   short avgOutTemp, avgInTemp; // tenths of a degree F (integrated over the day)\par
   short hiChill, lowChill;     // tenths of a degree F\par
   short hiDew, lowDew;         // tenths of a degree F\par
   short avgChill, avgDew;      // tenths of a degree F \par
   short hiOutHum, lowOutHum;   // tenths of a percent\par
   short hiInHum, lowInHum;     // tenths of a percent\par
   short avgOutHum;             // tenths of a percent\par
   short hiBar, lowBar;         // thousandths of an inch Hg\par
   short avgBar;                // thousandths of an inch Hg\par
   short hiSpeed, avgSpeed;     // tenths of an MPH\par
   short dailyWindRunTotal;     // 1/10'th of an mile \par
   short hi10MinSpeed;          // the highest average wind speed record \par
   BYTE  dirHiSpeed, hi10MinDir; // direction code (0-15, 255)\par
   short dailyRainTotal;        // 1/1000'th of an inch\par
   short hiRainRate;            // 1/100'th inch/hr ???\par
   short dailyUVDose;           // 1/10'th of a standard MED\par
   BYTE  hiUV;                  // tenth of a UV Index\par
   BYTE timeValues[27];         // space for 18 time values (see below)\par
\};  \par
\fs20\par
\fs18 // Daily Summary Record 2\par
struct DailySummary2\par
\{\par
   BYTE dataType = 3;\par
   BYTE  reserved;   // this will cause the rest of the fields to start on an even address\par
\par
   // this field is not used now.\par
   unsigned short todaysWeather; // bitmapped weather conditions (Fog, T-Storm, hurricane, etc)\par
\par
   short numWindPackets;      // # of valid packets containing wind data, \par
                              // this is used to indicate reception quality\par
   short hiSolar;             // Watts per meter squared\par
   short dailySolarEnergy;    // 1/10'th Ly\par
   short minSunlight;         // number of accumulated minutes where the avg solar rad > 150\par
   short dailyETTotal;        // 1/1000'th of an inch\par
   short hiHeat, lowHeat;     // tenths of a degree F\par
   short avgHeat;             // tenths of a degree F\par
   short hiTHSW, lowTHSW;     // tenths of a degree F\par
   short hiTHW, lowTHW;       // tenths of a degree F\par
\par
   short integratedHeatDD65;  // integrated Heating Degree Days (65F threshold)\par
                              // tenths of a degree F - Day\par
\par
   // Wet bulb values are not calculated\par
   short hiWetBulb, lowWetBulb; // tenths of a degree F\par
   short avgWetBulb;          // tenths of a degree F\par
\par
   BYTE dirBins[24];          // space for 16 direction bins \par
                              // (Used to calculate monthly dominant Dir)\par
\par
   BYTE timeValues[15];       // space for 10 time values (see below)\par
\par
   short integratedCoolDD65;  // integrated Cooling Degree Days (65F threshold)\par
                              // tenths of a degree F - Day\par
   BYTE  reserved2[11];\par
\};\par
\par
// standard archive record\par
struct WeatherDataRecord\par
\{\par
   BYTE dataType = 1;\par
   BYTE archiveInterval;      // number of minutes in the archive\par
   // see below for more details about these next two fields)\par
   BYTE iconFlags;            // Icon associated with this record, plus Edit flags\par
   BYTE moreFlags;            // Tx Id, etc.\par
\par
   short packedTime;          // minutes past midnight of the end of the archive period\par
   short outsideTemp;         // tenths of a degree F\par
   short hiOutsideTemp;       // tenths of a degree F\par
   short lowOutsideTemp;      // tenths of a degree F\par
   short insideTemp;          // tenths of a degree F\par
   short barometer;           // thousandths of an inch Hg\par
   short outsideHum;          // tenths of a percent\par
   short insideHum;           // tenths of a percent\par
   unsigned short rain;       // number of clicks + rain collector type code\par
   short hiRainRate;          // clicks per hour\par
   short windSpeed;           // tenths of an MPH\par
   short hiWindSpeed;         // tenths of an MPH\par
   BYTE windDirection;        // direction code (0-15, 255)\par
   BYTE hiWindDirection;      // direction code (0-15, 255)\par
   short numWindSamples;      // number of valid ISS packets containing wind data\par
                              // this is a good indication of reception \par
   short solarRad, hisolarRad;// Watts per meter squared \par
   BYTE  UV, hiUV;            // tenth of a UV Index\par
\par
   BYTE leafTemp[4];          // (whole degrees F) + 90\par
\par
   short extraRad;            // used to calculate extra heating effects of the sun in THSW index\par
   \par
   short newSensors[6];       // reserved for future use\par
   BYTE  forecast;            // forecast code during the archive interval\par
\par
   BYTE  ET;                  // in thousandths of an inch\par
   \par
   BYTE soilTemp[6];          // (whole degrees F) + 90\par
   BYTE soilMoisture[6];      // centibars of dryness\par
   BYTE leafWetness[4];       // Leaf Wetness code (0-15, 255)\par
   BYTE extraTemp[7];         // (whole degrees F) + 90\par
   BYTE extraHum[7];          // whole percent\par
\};\par
\par
Notes:\par
\par
Always check the dataType field to make sure you are reading the correct record type\par
\par
There are extra fields that are not used by the current software. For example, there is space for 7 extra temperatures and Hums, but current Vantage stations only log data for 3 extra temps and 2 extra hums.\par
\par
Extra/Soil/Leaf temperatures are in whole degrees with a 90 degree offset. A database value of 0 = -90 F, 100 = 10 F, etc.\par
\par
The rain collector type is encoded in the most significant nibble of the rain field. \par
rainCollectorType = (rainCode & 0xF000);\par
rainClicks = (rainCode & 0x0FFF);\par
\par
Type\tab\tab rainCollectorType \par
0.1 inch\tab 0x0000\par
0.01 inch\tab 0x1000\par
0.2 mm\tab\tab 0x2000\par
1.0 mm\tab\tab 0x3000\par
0.1 mm\tab\tab 0x6000 (not fully supported)\par
\par
Use the rainCollectorType to interpret the hiRainRate field. For example, if you have \par
a 0.01 in rain collector, a rain rate value of 19 = 0.19 in/hr = 4.8 mm/hr, but if you have \par
a 0.2 mm rain collector, a rain rate value of 19 = 3.8 mm/hr = 0.15 in/hr.\par
\par
Format for the iconFlags field\par
The lower nibble will hold a value that will represent an Icon to associate with this data record (i.e. snow, rain, sun, lightning, etc.). This field is not used.\par
\par
Bit (0x10) is set if the user has used the edit record function to change a data value. This allows tracking of edited data.\par
\par
Bit (0x20) is set if there is a data note associated with the archive record. If there is, it will be found in a text file named YYYYMMDDmmmm.NOTE. YYYY is the four digit year, MM is the two digit month (i.e. Jan = 01), DD is the two digit day, and mmmm is the number of minutes past midnight (i.e. the packedTime field). This file is found in the DATANOTE subdirectory of the station directory.\par
\par
Format for the moreFlags field\par
The lowest 3 bits contain the transmitter ID that is the source of the wind speed packets recorded in the numWindSamples field. This value is between 0 and 7. If your ISS is on ID 1, zero will be stored in this field.\par
\par
WindTxID = (moreFlags & 0x07);\par
\par
Time values and Wind direction values in Daily Summary records\par
These values are between 0 and 1440 and therefore will fit in 1 1/2 bytes, and 2 values fit in 3 bytes. Use this code to extract the i'th time or direction value. See below for the list of i values.\par
\par
fieldIndex = (i/2) * 3;\tab // note this is integer division (rounded down)\par
\par
if (i is even)\par
   value = field[fieldIndex] + (field[fieldIndex+2] & 0x0F)<<8;\par
\par
if (i is odd)    \par
   value = field[fieldIndex+1] + (field[fieldIndex+2] & 0xF0)<<4;\par
\par
A value of 0x0FFF or 0x07FF indicates no data available (i.e. invalid data)\par
\par
The time value represents the number of minutes after midnight that the specified event took place (actually the time of the archive record).\par
\par
The wind direction bins represent the number of minutes that that direction was the dominant wind direction for the day.\par
\par
Index values for Daily Summary Record 1 time values\par
Time of High Outside Temperature   0\par
Time of Low Outside Temperature    1\par
Time of High Inside Temperature    2\par
Time of Low Inside Temperature     3\par
Time of High Wind Chill            4\par
Time of Low Wind Chill             5\par
Time of High Dew Point             6\par
Time of Low Dew Point              7\par
Time of High Outside Humidity      8\par
Time of Low Outside Humidity       9\par
Time of High Inside Humidity      10\par
Time of Low Inside Humidity       11\par
Time of High Barometer            12\par
Time of Low Barometer             13\par
Time of High Wind Speed           14\par
Time of High Average Wind Speed   15\par
Time of High Rain Rate            16\par
Time of High UV                   17\par
\par
Index values for Daily Summary Record 2 time values \par
Time of High Solar Rad             0\par
Time of High Outside Heat Index    1\par
Time of Low Outside Heat Index     2\par
Time of High Outside THSW Index    3\par
Time of Low Outside THSW Index     4\par
Time of High Outside THW Index     5\par
Time of Low Outside THW Index      6\par
Time of High Outside Wet Bulb Temp 7\par
Time of Low Outside Wet Bulb Temp  8\par
(Time value 9 is not used)\par
\par
Index values for Dominant Wind direction bins in Daily Summary Record 2\par
N    0\par
NNE  1\par
NE   2\par
...\par
NW  14\par
NNW 15\par
\par
\ul\b\f0\fs20 Format of the Expansion_Modules\\ModuleList.dat file\par
\ulnone\b0\par
The file named ModuleList.dat in the directory Expansion_Modules, if it exists, tells WeatherLink which expansion modules to install. Each line of this text file lists information about one module, including whether or not to install it. WeatherLink will install the modules in the order listed in this file.\par
\par
The file format is:\par
<module file name> <module ID number> <module version> <load Flag> <full module name>\par
\par
<module file name> is the name of the DLL file that contains the expansion module.\par
\pard\nowidctlpar\fi-720\li720 <module ID number> is an ID number that uniquely identifies each module. The file name may change with different versions, but the ID will remain the same. This value is in hex.\par
<module version> is the version of the module installed. This is also in hex. for example 0x00010203 = version 1.2.3.\par
<load Flag> will either be "1" if the module should be loaded by WeatherLink or "0" if the module should not be loaded by WeatherLink\par
<full module name> is the module name, version, and date that appears in the WeatherLink About box for this module\par
\par
\pard\nowidctlpar\par
For example the entry for the Email/Phone Alert Module looks like:\par
\par
\f1 EmailAlertModule.dll 0x00000600 0x00010002 1 E-mail Alert Module v.1.0  04/07/2004\par
\f0\par
Where:\par
<module file name> = "EmailAlertModule.dll" \par
<module ID number> = 0x000000600\par
<module version> = 0x00010002 - version 1.0.2\par
<load Flag> = 1 = Load this module\par
<full module name> = "E-mail Alert Module v.1.0  04/07/2004"\par
\par
It is safe to delete lines or to change the order of lines (to change the order that modules are loaded into WeatherLink). If you wish to add a new module to the list, put the module file name on a line by itself. The next time WeatherLink is started, WeatherLink will try to load the module. If it is successfully loaded, the rest of the information will be added automatically by WeatherLink.\par
\par
\b The Module Management function under the File menu in WeatherLink will perform the same functions.\par
\par
\par
\ul Interpreting ISS Reception values\ulnone\par
\b0\par
The ISS Reception numbers are intended to show the overall quality level of the radio reception between the Vantage console and the ISS or Wireless Anemometer station. The reception value is calculated from the number of wind speed samples received by the console (reported in the Wind Samp column of the data browser) divided by the expected number of packets that could have been received. \par
\par
The expected number of packets is calculated from the Transmitter ID and the archive interval. This value is an average value which has been rounded to an integer. The actual number of packet transmissions over an archive interval can be more or less than the calculated value depending on the phase relationship between the transmission clock and the data archive clock.. \par
\par
This means that it is possible to receive more than 100% of the expected packets in an archive interval, and that there is a small amount of "noise" in the calculated percentages. \par
\par
The displayed reception value is limited to 100%.\par
\par
In addition, the number of packets with wind speed data received by a VantagePro 2 system is approximately 3% more than the number received by a VantagePro 1 system. The software, however, uses the same "expected number of packets" for both systems which will result in a small overestimation of the ISS reception value for VantagePro 2 systems.\par
\par
Below are tables that list the expected number of wind speed packets for each transmitter ID and archive interval. WeatherLink uses the VantagePro 1 table. The VantagePro 2 table is for reference.\par
\par
Expected number of Wind Speed packets\par
VantagePro 1\par
\tab Archive Interval (min)\par
Tx ID\tab 1\tab 5\tab 10\tab 15\tab 30\tab 60\tab 120\par
1\tab 23\tab 114\tab 228\tab 342\tab 684\tab 1368\tab 2736\par
2\tab 22\tab 111\tab 222\tab 333\tab 667\tab 1335\tab 2670\par
3\tab 22\tab 108\tab 218\tab 326\tab 652\tab 1302\tab 2606\par
4\tab 21\tab 106\tab 212\tab 318\tab 637\tab 1273\tab 2545\par
5\tab 21\tab 104\tab 207\tab 311\tab 622\tab 1244\tab 2487\par
6\tab 20\tab 102\tab 202\tab 304\tab 608\tab 1216\tab 2432\par
7\tab 20\tab 99\tab 199\tab 297\tab 595\tab 1189\tab 2379\par
8\tab 19\tab 97\tab 194\tab 291\tab 582\tab 1165\tab 2328\par
\par
VantagePro 2\par
\tab Archive Interval (min)\par
Tx ID\tab 1\tab 5\tab 10\tab 15\tab 30\tab 60\tab 120\par
1\tab 23\tab 117\tab 234\tab 351\tab 702\tab 1405\tab 2810\par
2\tab 23\tab 114\tab 229\tab 343\tab 686\tab 1371\tab 2743\par
3\tab 22\tab 112\tab 223\tab 335\tab 670\tab 1340\tab 2679\par
4\tab 22\tab 109\tab 218\tab 327\tab 655\tab 1309\tab 2618\par
5\tab 21\tab 107\tab 213\tab 320\tab 640\tab 1280\tab 2560\par
6\tab 21\tab 104\tab 209\tab 313\tab 626\tab 1252\tab 2504\par
7\tab 20\tab 102\tab 204\tab 306\tab 613\tab 1226\tab 2451\par
8\tab 20\tab 100\tab 200\tab 300\tab 600\tab 1200\tab 2400\par
\par
\par
}
 